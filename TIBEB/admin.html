<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Admin</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" type="text/css" href="css/all.min.css">
</head>
<body>
	<div class="banner">
		 <div class="navbar">
		 	<img src="img/logo.png" class="logo">
		 	<ul>
		 		<li><a href="index.html">Home</a></li>
		 		<li><a href="men.html">Men's</a></li>
		 		<li><a href="women.html">Women's</a></li>
		 		<li><a href="profile.html">Profile</a></li>
		 	</ul>
		 </div>
		 <div class="content">
			<h1><strong>Admin Dashboard</strong></h1>
		</div>
	</div>

	<div class="small-container">
		<h2>Create Product</h2>
		<form id="admin-create-form">
			<input type="text" name="name" placeholder="Name" required>
			<input type="number" name="price" placeholder="Price" step="0.01" required>
			<input type="text" name="category" placeholder="Category">
			<input type="number" name="inventoryCount" placeholder="Inventory">
			<textarea name="description" placeholder="Description"></textarea>
			<button type="submit" class="butn">Create</button>
		</form>

		<h2>Products</h2>
		<div id="admin-products"></div>

		<h2>Users</h2>
		<div id="admin-users"></div>

		<h2>Contact Messages</h2>
		<div id="admin-messages"></div>
	</div>

	<div class="footer">
		<div class="footer-content">
			<h3>Tibeb Habesha Clothing</h3>
			<p>Learn more about our passion for Ethiopian traditional clothing and our commitment to quality and authenticity.</p>
			<ul class="socials">
				<li><a href="#"><i class="fa-brands fa-facebook-f"></i></a></li>
				<li><a href="#"><i class="fa-brands fa-instagram"></i></a></li>
				<li><a href="#"><i class="fa-brands fa-tiktok"></i></a></li>
				<li><a href="#"><i class="fa-brands fa-x-twitter"></i></a></li>
				<li><a href="#"><i class="fa-brands fa-youtube"></i></a></li>
			</ul>
		</div>
		<div class="footer-bottom">
			<p>copyright &copy;2024 Tibeb habesha clothing. Designed by SAMUEL EMBAYE.</p>
		</div>
	</div>

	<script src="js/forms.js"></script>
	<script src="js/storefront.js"></script>
	<script>
	// admin-only fetch
	(async function(){
	  const token = localStorage.getItem('token');
	  async function authFetch(url){
	    const res = await fetch(url, { headers: token ? { Authorization: `Bearer ${token}` } : {} });
	    const data = await res.json();
	    if(!res.ok) throw new Error(data.error || 'Failed');
	    return data;
	  }
	  try {
	    const [users, messages] = await Promise.all([
	      authFetch('/api/admin/users'),
	      authFetch('/api/admin/contacts')
	    ]);
	    const usersEl = document.getElementById('admin-users');
	    usersEl.innerHTML = users.map(u => `<div>${u.firstName} ${u.lastName} - ${u.email} (${u.role})</div>`).join('');
	    const msgEl = document.getElementById('admin-messages');
	    msgEl.innerHTML = messages.map(m => `<div><strong>${m.fullName}</strong> (${m.email}): ${m.message}</div>`).join('');
	  } catch(e) {
	    console.warn(e);
	  }
	})();
	</script>
</body>
</html>

